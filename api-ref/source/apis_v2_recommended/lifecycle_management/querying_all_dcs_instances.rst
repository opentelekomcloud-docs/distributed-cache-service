:original_name: ListInstances.html

.. _ListInstances:

Querying All DCS Instances
==========================

Function
--------

This API is used to query DCS instances of a tenant, and allows you to specify query criteria.

URI
---

GET /v2/{project_id}/instances

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+-------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                   |
   +============+===========+========+===============================================================================+
   | project_id | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID <dcs-api-0312045>`. |
   +------------+-----------+--------+-------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                                                                                           |
   +=================+=================+=================+=======================================================================================================================================================================================================================+
   | instance_id     | No              | String          | Instance ID.                                                                                                                                                                                                          |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | include_failure | No              | String          | Whether to return the number of instances that fail to be created. If the value is **true**, the number of instances that failed to be created is returned. If the value is not **true**, the number is not returned. |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | include_delete  | No              | String          | Whether to return the number of instances that have been deleted. If the value is **true**, the number of instances that have been deleted is returned. If the value is not **true**, the number is not returned.     |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name            | No              | String          | Instance name.                                                                                                                                                                                                        |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | offset          | No              | Integer         | Offset, which is the position where the query starts. The value must be greater than or equal to 0.                                                                                                                   |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit           | No              | Integer         | Number of records displayed on each page. The minimum value is **1**. The maximum value is **1000**. If this parameter is not specified, 10 records are displayed on each page by default.                            |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status          | No              | String          | Instance status. For details, see :ref:`DCS Instance Statuses <dcs-api-0312047>`.                                                                                                                                     |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name_equal      | No              | String          | Whether to search for the instance that precisely matches a specified instance name.                                                                                                                                  |
   |                 |                 |                 |                                                                                                                                                                                                                       |
   |                 |                 |                 | The default value is *false*, indicating that a fuzzy search is performed based on a specified instance name. If the value is **true**, the instance that precisely matches a specified instance name is queried.     |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tags            | No              | String          | The query is based on the instance tag key and value. *{key}* indicates the tag key, and *{value}* indicates the tag value.                                                                                           |
   |                 |                 |                 |                                                                                                                                                                                                                       |
   |                 |                 |                 | To query instances with multiple tag keys and values, separate key-value pairs with commas (,).                                                                                                                       |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ip              | No              | String          | IP address for connecting to the DCS instance.                                                                                                                                                                        |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | capacity        | No              | String          | DCS instance cache capacity in GB.                                                                                                                                                                                    |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

None

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +--------------+-------------------------------------------------------------------------------------+-------------------------+
   | Parameter    | Type                                                                                | Description             |
   +==============+=====================================================================================+=========================+
   | instance_num | Integer                                                                             | Number of instances.    |
   +--------------+-------------------------------------------------------------------------------------+-------------------------+
   | instances    | Array of :ref:`InstanceListInfo <listinstances__response_instancelistinfo>` objects | Instance details array. |
   +--------------+-------------------------------------------------------------------------------------+-------------------------+

.. _listinstances__response_instancelistinfo:

.. table:: **Table 4** InstanceListInfo

   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                      | Description                                                                                                                                                                  |
   +=======================+===========================================================================+==============================================================================================================================================================================+
   | publicip_id           | String                                                                    | ID of the EIP bound to the DCS Redis instance. This parameter is reserved. The value is **null**.                                                                            |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | vpc_name              | String                                                                    | VPC name.                                                                                                                                                                    |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | charging_mode         | Integer                                                                   | Billing mode. The value can be **0**: pay-per-use.                                                                                                                           |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | vpc_id                | String                                                                    | VPC ID.                                                                                                                                                                      |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | subnet_id             | String                                                                    | Subnet ID.                                                                                                                                                                   |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | security_group_id     | String                                                                    | Security group ID.                                                                                                                                                           |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | created_at            | String                                                                    | Creation time. Format: 2017-03-31T12:24:46.297Z                                                                                                                              |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | updated_at            | String                                                                    | Update time. Format: 2017-03-31T19:24:46.297Z.                                                                                                                               |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enable_ssl            | Boolean                                                                   | This parameter is reserved.                                                                                                                                                  |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | max_memory            | Integer                                                                   | Total memory size in MB.                                                                                                                                                     |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | used_memory           | Integer                                                                   | Used memory size in MB.                                                                                                                                                      |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | publicip_address      | String                                                                    | EIP bound to the DCS Redis instance. This parameter is reserved. The value is **null**.                                                                                      |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | capacity              | Integer                                                                   | Cache capacity (GB)                                                                                                                                                          |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | capacity_minor        | String                                                                    | Capacity (GB) of a small DCS instance (smaller than 1 GB).                                                                                                                   |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | order_id              | String                                                                    | Order ID. The value is null when a pay-per-use instance is created.                                                                                                          |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | maintain_begin        | String                                                                    | UTC time when the maintenance time window starts. The format is HH:mm:ss.                                                                                                    |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | maintain_end          | String                                                                    | UTC time when the maintenance time window ends. The format is HH:mm:ss.                                                                                                      |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | engine                | String                                                                    | Cache engine.                                                                                                                                                                |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | engine_version        | String                                                                    | Cache version.                                                                                                                                                               |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | service_upgrade       | Boolean                                                                   | Whether the instance has an upgrade task.                                                                                                                                    |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  **true**: yes                                                                                                                                                             |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  **false**: no                                                                                                                                                             |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | no_password_access    | String                                                                    | Indicates whether the instance can be accessed without a password.                                                                                                           |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  **true**: The instance can be accessed without a password.                                                                                                                |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  **false**: The instance can be accessed only after password authentication.                                                                                               |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | service_task_id       | String                                                                    | Upgrade task ID.                                                                                                                                                             |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  If the value of **service_upgrade** is set to **true**, the value of this parameter is the ID of the upgrade task.                                                        |
   |                       |                                                                           |                                                                                                                                                                              |
   |                       |                                                                           | -  If the value of **service_upgrade** is set to **false**, the value of this parameter is empty.                                                                            |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ip                    | String                                                                    | IP address for connecting to the DCS instance. For a cluster instance, multiple IP addresses are returned and separated by commas (,). For example, 192.168.0.1,192.168.0.2. |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | access_user           | String                                                                    | Username used for accessing a DCS instance after password authentication.                                                                                                    |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | instance_id           | String                                                                    | Instance ID.                                                                                                                                                                 |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enable_publicip       | Boolean                                                                   | This parameter is reserved.                                                                                                                                                  |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | port                  | Integer                                                                   | Port of the DCS instance.                                                                                                                                                    |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | user_id               | String                                                                    | User ID.                                                                                                                                                                     |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | user_name             | String                                                                    | Username.                                                                                                                                                                    |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | domain_name           | String                                                                    | Domain name of the instance.                                                                                                                                                 |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | readonly_domain_name  | String                                                                    | Read-only domain name of the instance. This parameter is available only for master/standby instances.                                                                        |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                  | String                                                                    | Instance name.                                                                                                                                                               |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | spec_code             | String                                                                    | Product flavor.                                                                                                                                                              |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                | String                                                                    | Instance status. For details, see :ref:`DCS Instance Statuses <dcs-api-0312047>`.                                                                                            |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tags                  | Array of :ref:`ResourceTag <listinstances__response_resourcetag>` objects | Instance tag key and value.                                                                                                                                                  |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id | String                                                                    | Enterprise project ID.                                                                                                                                                       |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description           | String                                                                    | Description about the instance.                                                                                                                                              |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | cpu_type              | String                                                                    | CPU type of the instance. Generally, the value is **x86_64** or **aarch64**.                                                                                                 |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | az_codes              | Array of strings                                                          | AZs where there are available resources.                                                                                                                                     |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | features              | :ref:`Features <listinstances__response_features>` object                 | Features supported by the instance.                                                                                                                                          |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | sub_status            | String                                                                    | Instance sub-status.                                                                                                                                                         |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listinstances__response_resourcetag:

.. table:: **Table 5** ResourceTag

   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                               |
   +=======================+=======================+===========================================================================================================================+
   | key                   | String                | Tag key.                                                                                                                  |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  Must be specified.                                                                                                     |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  Must be unique for each resource.                                                                                      |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  Can contain a maximum of 36 characters.                                                                                |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  Must be unique and cannot be empty.                                                                                    |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------+
   | value                 | String                | Tag value.                                                                                                                |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  This parameter is mandatory when **action** is set to **create** and is optional when **action** is set to **delete**. |
   |                       |                       |                                                                                                                           |
   |                       |                       | -  It can contain a maximum of 43 characters.                                                                             |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------+

.. _listinstances__response_features:

.. table:: **Table 6** Features

   +-------------------------------+-----------------------+--------------------------------------------+
   | Parameter                     | Type                  | Description                                |
   +===============================+=======================+============================================+
   | support_acl                   | Boolean               | Whether ACL is supported.                  |
   |                               |                       |                                            |
   |                               |                       | -  **true**: Yes                           |
   |                               |                       |                                            |
   |                               |                       | -  **false**: No                           |
   +-------------------------------+-----------------------+--------------------------------------------+
   | support_transparent_client_ip | Boolean               | Whether client IP pass-through is enabled. |
   |                               |                       |                                            |
   |                               |                       | -  **true**: Yes                           |
   |                               |                       |                                            |
   |                               |                       | -  **false**: No                           |
   +-------------------------------+-----------------------+--------------------------------------------+
   | support_ssl                   | Boolean               | Whether SSL is supported.                  |
   |                               |                       |                                            |
   |                               |                       | -  **true**: Yes                           |
   |                               |                       |                                            |
   |                               |                       | -  **false**: No                           |
   +-------------------------------+-----------------------+--------------------------------------------+
   | support_audit_log             | Boolean               | Whether audit logs are supported           |
   |                               |                       |                                            |
   |                               |                       | -  **true**: Yes                           |
   |                               |                       |                                            |
   |                               |                       | -  **false**: No                           |
   +-------------------------------+-----------------------+--------------------------------------------+

**Status code: 400**

.. table:: **Table 7** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 401**

.. table:: **Table 8** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 403**

.. table:: **Table 9** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 404**

.. table:: **Table 10** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 500**

.. table:: **Table 11** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET https://{dcs_endpoint}/v2/{project_id}/instances?offset=0&limit=10&name={name}&status={status}&id={id}&include_failure=true&include_delete=true&name_equal=false

Example Responses
-----------------

**Status code: 400**

Invalid request.

.. code-block::

   {
     "error_code" : "DCS.4800",
     "error_msg" : "Invalid offset in the request."
   }

Status Codes
------------

=========== ======================================
Status Code Description
=========== ======================================
200         All instances are listed successfully.
400         Invalid request.
401         Invalid authentication information.
403         The request is rejected.
404         The requested resource is not found.
500         Internal service error.
=========== ======================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
