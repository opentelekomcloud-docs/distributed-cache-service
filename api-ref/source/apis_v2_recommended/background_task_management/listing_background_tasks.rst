:original_name: ListBackgroundTask.html

.. _ListBackgroundTask:

Listing Background Tasks
========================

Function
--------

This API is used to query background tasks.

URI
---

GET /v2/{project_id}/instances/{instance_id}/tasks

.. table:: **Table 1** Path Parameters

   +-------------+-----------+--------+-------------------------------------------------------------------------------+
   | Parameter   | Mandatory | Type   | Description                                                                   |
   +=============+===========+========+===============================================================================+
   | project_id  | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID <dcs-api-0312045>`. |
   +-------------+-----------+--------+-------------------------------------------------------------------------------+
   | instance_id | Yes       | String | Instance ID.                                                                  |
   +-------------+-----------+--------+-------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type    | Description                                                                                         |
   +============+===========+=========+=====================================================================================================+
   | offset     | No        | Integer | Offset, which is the position where the query starts. The value must be greater than or equal to 0. |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------+
   | limit      | No        | Integer | Number of items displayed on each page.                                                             |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------+
   | start_time | No        | String  | Query start time (UTC). Format: yyyyMMddHHmmss, for example, **20200609160000**.                    |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------+
   | end_time   | No        | String  | Query end time (UTC). Format: yyyyMMddHHmmss, for example, **20200617155959**.                      |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------+

Request Parameters
------------------

None

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +------------+--------------------------------------------------------------------------------------------------+---------------------+
   | Parameter  | Type                                                                                             | Description         |
   +============+==================================================================================================+=====================+
   | task_count | String                                                                                           | Number of tasks.    |
   +------------+--------------------------------------------------------------------------------------------------+---------------------+
   | tasks      | Array of :ref:`SingleBackgroundTask <listbackgroundtask__response_singlebackgroundtask>` objects | Task details array. |
   +------------+--------------------------------------------------------------------------------------------------+---------------------+

.. _listbackgroundtask__response_singlebackgroundtask:

.. table:: **Table 4** SingleBackgroundTask

   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | Parameter             | Type                                                                 | Description                                              |
   +=======================+======================================================================+==========================================================+
   | id                    | String                                                               | Background task ID.                                      |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | name                  | String                                                               | Background task name. The options are as follows:        |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **EXTEND**: modifying specifications                     |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **BindEip**: enabling public access                      |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **UnBindEip**: disabling public access                   |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **AddReplica**: adding replicas                          |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **DelReplica**: deleting replicas                        |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **AddWhitelist**: configuring an IP whitelist            |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **UpdatePort**: changing the port                        |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **RemoveIpFromDns**: removing IP addresses               |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **masterStandbySwapJob**: master/standby switchover      |
   |                       |                                                                      |                                                          |
   |                       |                                                                      | **modify**: changing the password                        |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | details               | :ref:`DetailsBody <listbackgroundtask__response_detailsbody>` object | Details.                                                 |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | user_name             | String                                                               | Username.                                                |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | user_id               | String                                                               | User ID.                                                 |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | params                | String                                                               | Task parameters.                                         |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | status                | String                                                               | Task status.                                             |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | created_at            | String                                                               | Task start time, in the format 2020-06-17T07:38:42.503Z. |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | updated_at            | String                                                               | Task end time, in the format 2020-06-17T07:38:42.503Z.   |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+
   | enable_show           | Boolean                                                              | Task details that can be expanded.                       |
   +-----------------------+----------------------------------------------------------------------+----------------------------------------------------------+

.. _listbackgroundtask__response_detailsbody:

.. table:: **Table 5** DetailsBody

   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | Parameter               | Type             | Description                                                                                                            |
   +=========================+==================+========================================================================================================================+
   | old_capacity            | String           | Capacity before the modification. This parameter has a value only when the specifications are modified.                |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_capacity            | String           | Capacity after the modification. This parameter has a value only when the specifications are modified.                 |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | enable_public_ip        | Boolean          | Whether to enable public access. This parameter has a value only when public access is enabled.                        |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | public_ip_id            | String           | ID of the IP address used for public access. This parameter has a value only when public access is enabled.            |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | public_ip_address       | String           | IP address used for public access. This parameter has a value only when public access is enabled.                      |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | enable_ssl              | Boolean          | Whether to enable SSL. This parameter has a value only when SSL is enabled.                                            |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | old_cache_mode          | String           | Cache type before the modification. This parameter has a value only when the specifications are modified.              |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_cache_mode          | String           | Cache type after the modification. This parameter has a value only when the specifications are modified.               |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | old_resource_spec_code  | String           | Specification parameter before the modification. This parameter has a value only when the specifications are modified. |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_resource_spec_code  | String           | Specification parameter after the modification. This parameter has a value only when the specifications are modified.  |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | old_replica_num         | Integer          | Number of replicas before the modification. This parameter has a value only when the specifications are modified.      |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_replica_num         | Integer          | Number of replicas after the modification. This parameter has a value only when the specifications are modified.       |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | old_cache_type          | String           | Cache type before the modification. This parameter has a value only when the specifications are modified.              |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_cache_type          | String           | Specification type after the modification. This parameter has a value only when the specifications are modified.       |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | replica_ip              | String           | Replica IP address.                                                                                                    |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | replica_az              | String           | AZ where the replica is in.                                                                                            |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | group_name              | String           | Group name.                                                                                                            |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | old_port                | Integer          | Old port.                                                                                                              |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | new_port                | Integer          | New port.                                                                                                              |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | is_only_adjust_charging | Boolean          | Indicates whether to only change the billing mode.                                                                     |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | account_name            | String           | Account name.                                                                                                          |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | source_ip               | String           | Source IP address.                                                                                                     |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | target_ip               | String           | Target IP address.                                                                                                     |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | node_name               | String           | Node information.                                                                                                      |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | rename_commands         | Array of strings | Renamed command.                                                                                                       |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+
   | updated_config_length   | Integer          | Length of the updated configuration item.                                                                              |
   +-------------------------+------------------+------------------------------------------------------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 6** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 401**

.. table:: **Table 7** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 403**

.. table:: **Table 8** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 404**

.. table:: **Table 9** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 500**

.. table:: **Table 10** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET https://{dcs_endpoint}/v2/a4d31cb6-3d72-4fdc-8ec9-6e3a41e47f71/instances/5560df16-cebf-4473-95c4-d1b573c16e79/tasks?offset=0&limit=10&begin_time=20200609160000&end_time=20200617155959

Example Responses
-----------------

**Status code: 200**

Background tasks listed successfully.

.. code-block::

   {
     "task_count" : 1,
     "tasks" : [ {
       "id" : "8abf6e1e72c12e7c0172c15b508500aa",
       "name" : "EXTEND",
       "user_name" : "dcs_000_02",
       "user_id" : "d53977d1adfb49c5b025ba7d33a13fd7",
       "details" : {
         "old_cache_mode" : "single",
         "new_cache_mode" : "single",
         "old_capacity" : "0.125",
         "new_capacity" : "0.25",
         "old_resource_spec_code" : "redis.single.xu1.tiny.125",
         "new_resource_spec_code" : "redis.single.xu1.tiny.256",
         "old_replica_num" : 1,
         "new_replica_num" : 1,
         "old_cache_type" : "single",
         "new_cache_type" : "single",
         "replica_ip" : "192.192.0.1",
         "replica_az" : "az01",
         "group_name" : "group1",
         "old_port" : 6379,
         "new_port" : 6379,
         "is_only_adjust_charging" : false,
         "account_name" : "account1",
         "source_ip" : "192.192.0.0",
         "target_ip" : "192.192.0.1",
         "node_name" : "node1",
         "rename_commands" : [ ],
         "updated_config_length" : 0
       },
       "enable_show" : false,
       "status" : "SUCCESS",
       "created_at" : "2020-06-17T08:18:06.597Z",
       "updated_at" : "2020-06-17T08:18:10.106Z"
     } ]
   }

Status Codes
------------

=========== =====================================
Status Code Description
=========== =====================================
200         Background tasks listed successfully.
400         Invalid request.
401         Invalid authentication information.
403         The request is rejected.
404         The requested resource is not found.
500         Internal service error.
=========== =====================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
