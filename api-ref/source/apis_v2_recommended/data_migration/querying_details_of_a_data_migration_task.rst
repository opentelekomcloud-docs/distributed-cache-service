:original_name: ShowMigrationTask.html

.. _ShowMigrationTask:

Querying Details of a Data Migration Task
=========================================

Function
--------

This API is used to query migration task details.

URI
---

GET /v2/{project_id}/migration-task/{task_id}

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+-------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                   |
   +============+===========+========+===============================================================================+
   | project_id | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID <dcs-api-0312045>`. |
   +------------+-----------+--------+-------------------------------------------------------------------------------+
   | task_id    | Yes       | String | Task ID.                                                                      |
   +------------+-----------+--------+-------------------------------------------------------------------------------+

Request Parameters
------------------

None

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 2** Response body parameters

   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                | Type                                                                              | Description                                                                                                                                                                                                                        |
   +==========================+===================================================================================+====================================================================================================================================================================================================================================+
   | task_id                  | String                                                                            | Migration task ID.                                                                                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | task_name                | String                                                                            | Migration task name.                                                                                                                                                                                                               |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description              | String                                                                            | Migration task description.                                                                                                                                                                                                        |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                   | String                                                                            | Migration task status. The value can be **SUCCESS**, **FAILED**, **MIGRATING**, **TERMINATED**, **TERMINATING**, **INCRMIGRATING**, **FULLMIGRATING**, **RUNNING** (pending configuration), **MIGRATION_FAILED**, or **RELEASED**. |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | migration_type           | String                                                                            | Migration mode, which can be backup file import or online migration.                                                                                                                                                               |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | migration_method         | String                                                                            | Type of the migration, which can be full migration or incremental migration.                                                                                                                                                       |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ecs_tenant_private_ip    | String                                                                            | Private IP address of the migration ECS on the tenant side. This IP address can be added to the whitelist if it is in the same VPC as the private IP address of the target or source Redis.                                        |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | backup_files             | :ref:`BackupFilesBody <showmigrationtask__response_backupfilesbody>` object       | Backup files to be imported when the migration mode is backup file import.                                                                                                                                                         |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | network_type             | String                                                                            | Network type, which can be VPC or VPN.                                                                                                                                                                                             |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | source_instance          | :ref:`SourceInstanceBody <showmigrationtask__response_sourceinstancebody>` object | Source Redis information. This parameter is mandatory for online migration.                                                                                                                                                        |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | target_instance          | :ref:`TargetInstanceBody <showmigrationtask__response_targetinstancebody>` object | Target Redis instance information.                                                                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | created_at               | String                                                                            | Time when the migration task is created.                                                                                                                                                                                           |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | updated_at               | String                                                                            | Time when the migration task is complete.                                                                                                                                                                                          |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | released_at              | String                                                                            | Time when the migration ECS is released.                                                                                                                                                                                           |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version                  | String                                                                            | Version.                                                                                                                                                                                                                           |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | resume_mode              | String                                                                            | Operation mode, which can be **auto** or **manual**.                                                                                                                                                                               |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | supported_features       | Array of strings                                                                  | Supported features.                                                                                                                                                                                                                |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tenant_vpc_id            | String                                                                            | VPC ID.                                                                                                                                                                                                                            |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tenant_subnet_id         | String                                                                            | Subnet ID.                                                                                                                                                                                                                         |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tenant_security_group_id | String                                                                            | Security group ID.                                                                                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bandwidth_limit_mb       | String                                                                            | Maximum bandwidth.                                                                                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | task_status              | String                                                                            | Task status. **EXCHANGING** is returned only when IP addresses are being switched.                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _showmigrationtask__response_backupfilesbody:

.. table:: **Table 3** BackupFilesBody

   +-------------+-------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+
   | Parameter   | Type                                                              | Description                                                                                             |
   +=============+===================================================================+=========================================================================================================+
   | file_source | String                                                            | Data source, which can be an OBS bucket or a backup record.                                             |
   +-------------+-------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+
   | bucket_name | String                                                            | Name of the OBS bucket.                                                                                 |
   +-------------+-------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+
   | files       | Array of :ref:`Files <showmigrationtask__response_files>` objects | List of backup files to be imported. This parameter is mandatory when the data source is an OBS bucket. |
   +-------------+-------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+
   | backup_id   | String                                                            | Backup record ID. This parameter is mandatory when the data source is a backup record.                  |
   +-------------+-------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+

.. _showmigrationtask__response_files:

.. table:: **Table 4** Files

   +-----------+--------+--------------------------------------------------------------------------+
   | Parameter | Type   | Description                                                              |
   +===========+========+==========================================================================+
   | file_name | String | Name of a backup file.                                                   |
   +-----------+--------+--------------------------------------------------------------------------+
   | size      | String | File size in bytes.                                                      |
   +-----------+--------+--------------------------------------------------------------------------+
   | update_at | String | Time when the file was last modified. The format is YYYY-MM-DD HH:MM:SS. |
   +-----------+--------+--------------------------------------------------------------------------+

.. _showmigrationtask__response_sourceinstancebody:

.. table:: **Table 5** SourceInstanceBody

   +----------------+---------+------------------------------------------------------------------------+
   | Parameter      | Type    | Description                                                            |
   +================+=========+========================================================================+
   | addrs          | String  | Source Redis address (specified in the **source_instance** parameter). |
   +----------------+---------+------------------------------------------------------------------------+
   | password       | String  | Redis password. If a password is set, this parameter is mandatory.     |
   +----------------+---------+------------------------------------------------------------------------+
   | task_status    | String  | Task status.                                                           |
   +----------------+---------+------------------------------------------------------------------------+
   | id             | String  | Redis instance ID.                                                     |
   +----------------+---------+------------------------------------------------------------------------+
   | ip             | String  | Redis IP address.                                                      |
   +----------------+---------+------------------------------------------------------------------------+
   | port           | String  | Redis port.                                                            |
   +----------------+---------+------------------------------------------------------------------------+
   | name           | String  | Redis name.                                                            |
   +----------------+---------+------------------------------------------------------------------------+
   | proxy_multi_db | Boolean | Indicates whether multi-DB is enabled for Proxy Cluster DCS instances. |
   +----------------+---------+------------------------------------------------------------------------+
   | db             | String  | Redis database.                                                        |
   +----------------+---------+------------------------------------------------------------------------+

.. _showmigrationtask__response_targetinstancebody:

.. table:: **Table 6** TargetInstanceBody

   +----------------+---------+------------------------------------------------------------------------+
   | Parameter      | Type    | Description                                                            |
   +================+=========+========================================================================+
   | id             | String  | Redis instance ID (mandatory in the **target_instance** parameter).    |
   +----------------+---------+------------------------------------------------------------------------+
   | name           | String  | Redis instance name (specified in the **target_instance** parameter).  |
   +----------------+---------+------------------------------------------------------------------------+
   | password       | String  | Redis password. If a password is set, this parameter is mandatory.     |
   +----------------+---------+------------------------------------------------------------------------+
   | task_status    | String  | Task status.                                                           |
   +----------------+---------+------------------------------------------------------------------------+
   | ip             | String  | Redis IP address.                                                      |
   +----------------+---------+------------------------------------------------------------------------+
   | port           | String  | Redis port.                                                            |
   +----------------+---------+------------------------------------------------------------------------+
   | addrs          | String  | Redis instance address.                                                |
   +----------------+---------+------------------------------------------------------------------------+
   | proxy_multi_db | Boolean | Indicates whether multi-DB is enabled for Proxy Cluster DCS instances. |
   +----------------+---------+------------------------------------------------------------------------+
   | db             | String  | Redis database.                                                        |
   +----------------+---------+------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 7** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 401**

.. table:: **Table 8** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 403**

.. table:: **Table 9** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 404**

.. table:: **Table 10** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

**Status code: 500**

.. table:: **Table 11** Response body parameters

   +---------------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Type   | Description                                                                              |
   +===============+========+==========================================================================================+
   | error_msg     | String | Error message.                                                                           |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_code    | String | Error code.                                                                              |
   +---------------+--------+------------------------------------------------------------------------------------------+
   | error_ext_msg | String | Extended error information. This parameter is not used currently and is set to **null**. |
   +---------------+--------+------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET https://{dcs_endpoint}/v2/254d2280acb74d36a8b839746bcd7352 /migration-task/a276c1ffa0a54c2597fc824b917db317

Example Responses
-----------------

**Status code: 200**

Details of a data migration task queried successfully.

.. code-block::

   {
     "task_name" : "migration1",
     "task_id" : "a276c1ffa0a54c2597fc824b917db317",
     "status" : "TERMINATING",
     "migration_type" : "incremental_migration",
     "network_type" : "vpc",
     "source_instance" : {
       "addrs" : "192.168.1.2:6379",
       "id" : "86157b69-8a62-47f9-8c55-fa6ddc8927e1",
       "name" : "dcs-test",
       "ip" : "192.168.1.2",
       "port" : "6379",
       "proxy_multi_db" : false,
       "password" : "DCStest123",
       "task_status" : "RUNNING",
       "db" : "0"
     },
     "target_instance" : {
       "addrs" : "192.168.1.2:6379",
       "id" : "86157b69-8a62-47f9-8c55-fa6ddc8927ee",
       "name" : "test-instance",
       "ip" : "192.168.1.2",
       "port" : "6379",
       "proxy_multi_db" : false,
       "password" : "DCStest123",
       "task_status" : "RUNNING",
       "db" : "0"
     },
     "created_at" : "2019/10/22 14:44:30",
     "updated_at" : "2019/10/22 18:00:00"
   }

Status Codes
------------

=========== ======================================================
Status Code Description
=========== ======================================================
200         Details of a data migration task queried successfully.
400         Invalid request.
401         Invalid authentication information.
403         The request is rejected.
404         The requested resource is not found.
500         Internal service error.
=========== ======================================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
