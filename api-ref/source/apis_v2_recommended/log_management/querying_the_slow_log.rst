:original_name: ListSlowlog.html

.. _ListSlowlog:

Querying the Slow Log
=====================

Function
--------

This API is used to query slow logs.

URI
---

GET /v2/{project_id}/instances/{instance_id}/slowlog

.. table:: **Table 1** Path Parameters

   +-------------+-----------+--------+-------------------------------------------------------------------------------+
   | Parameter   | Mandatory | Type   | Description                                                                   |
   +=============+===========+========+===============================================================================+
   | project_id  | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID <dcs-api-0312045>`. |
   +-------------+-----------+--------+-------------------------------------------------------------------------------+
   | instance_id | Yes       | String | Instance ID.                                                                  |
   +-------------+-----------+--------+-------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                               |
   +=================+=================+=================+===========================================================================================================================================================+
   | offset          | No              | Integer         | Offset, which is the position where the query starts. The value must be no less than 0.                                                                   |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit           | No              | Integer         | Number of items displayed on each page.                                                                                                                   |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | sort_key        | No              | String          | Specifies the keyword based on which the return results are sorted. The value can be **start_time** or **duration**. The default value is **start_time**. |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | Enumeration values:                                                                                                                                       |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | -  **start_time**                                                                                                                                         |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | -  **duration**                                                                                                                                           |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | sort_dir        | No              | String          | Result sorting order. The value can be **desc** (descending order) or **asc** (ascending order). The default value is **desc**.                           |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | Enumeration values:                                                                                                                                       |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | -  **desc**                                                                                                                                               |
   |                 |                 |                 |                                                                                                                                                           |
   |                 |                 |                 | -  **asc**                                                                                                                                                |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | start_time      | Yes             | String          | Query start time (UTC). Example: **1598803200000**.                                                                                                       |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | end_time        | Yes             | String          | Query end time (UTC). Example: 1599494399000.                                                                                                             |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

None

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +-----------+-------------------------------------------------------------------------+----------------------------+
   | Parameter | Type                                                                    | Description                |
   +===========+=========================================================================+============================+
   | total_num | Integer                                                                 | Total number of slow logs. |
   +-----------+-------------------------------------------------------------------------+----------------------------+
   | count     | Integer                                                                 | Total.                     |
   +-----------+-------------------------------------------------------------------------+----------------------------+
   | slowlogs  | Array of :ref:`SlowlogItem <listslowlog__response_slowlogitem>` objects | Slow log list.             |
   +-----------+-------------------------------------------------------------------------+----------------------------+

.. _listslowlog__response_slowlogitem:

.. table:: **Table 4** SlowlogItem

   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | Parameter   | Type    | Description                                                                                                               |
   +=============+=========+===========================================================================================================================+
   | id          | Integer | Unique ID of a slow log.                                                                                                  |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | command     | String  | Slow command.                                                                                                             |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | start_time  | String  | Execution start time. Example: **2020-06-19T07:06:07Z**.                                                                  |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | duration    | String  | Duration, in ms.                                                                                                          |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | shard_name  | String  | Name of the shard where the slow command is executed. This parameter is supported only when the instance type is cluster. |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | database_id | Integer | Database ID, which is available only to some customers.                                                                   |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+
   | username    | String  | Account name that can operate slow logs. This parameter is available only to designated customers.                        |
   +-------------+---------+---------------------------------------------------------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 5** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 401**

.. table:: **Table 6** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 403**

.. table:: **Table 7** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 404**

.. table:: **Table 8** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

**Status code: 500**

.. table:: **Table 9** Response body parameters

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                              |
   +=======================+=======================+==========================================================================================+
   | error_msg             | String                | Error message.                                                                           |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_code            | String                | Error code.                                                                              |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **9**                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+
   | error_ext_msg         | String                | Extended error information. This parameter is not used currently and is set to **null**. |
   |                       |                       |                                                                                          |
   |                       |                       | Maximum: **1024**                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET https://{dcs_endpoint}/v2/a4d31cb6-3d72-4fdc-8ec9-6e3a41e47f71/instances/5560df16-cebf-4473-95c4-d1b573c16e79/slowlog?start_time=1598803200000&end_time=1599494399000

Example Responses
-----------------

**Status code: 200**

Slow logs queried successfully.

.. code-block::

   {
     "total_num" : 1,
     "count" : 1,
     "slowlogs" : [ {
       "id" : 1,
       "start_time" : "2020-06-19T07:06:07Z",
       "command" : "SLOWLOG GET 128",
       "duration" : "17",
       "shard_name" : "group-0",
       "database_id" : 1,
       "username" : "default"
     } ]
   }

**Status code: 400**

Invalid request.

.. code-block::

   {
     "error_code" : "DCS.4800",
     "error_msg" : "Invalid start_time in the request."
   }

Status Codes
------------

=========== ====================================
Status Code Description
=========== ====================================
200         Slow logs queried successfully.
400         Invalid request.
401         Invalid authentication information.
403         The request is rejected.
404         The requested resource is not found.
500         Internal service error.
=========== ====================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
